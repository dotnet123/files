@page
@model WebApplication1.Pages.Part.ShowModel
@{
    ViewData["Title"] = "Show";
    Layout = "~/Pages/Part/Layout1.cshtml";
}

<div class="layui-container">

    <fieldset class="layui-elem-field layui-field-title" style="margin-top: 30px;">
        <legend>@Model.pan.Name.@Model.pan.Ext</legend>
    </fieldset>
    <script>
    function setIframeHeight(iframe) {
            if (iframe) {
                var iframeWin = iframe.contentWindow || iframe.contentDocument.parentWindow;
                if (iframeWin.document.body) {
                    iframe.height = iframeWin.document.documentElement.scrollHeight || iframeWin.document.body.scrollHeight;
                }
            }
        };</script>
    @if (Model.type == 1)
    {
        <blockquote class="layui-elem-quote"><img src="/@Model.pan.Url"/></blockquote>
    }
    else if (Model.type == 2)
    {
        <blockquote class="layui-elem-quote layui-quote-nm">
            <iframe id="iframe" src="http://ow365.cn/?i=14789&furl=http://47.97.207.194:9090/@Model.pan.Url"
                    style="min-height: 773px;" frameborder="0" width="100%" scrolling="yes" onload="setIframeHeight(this)"></iframe>
        </blockquote>
    }
    else
    {
        <blockquote class="layui-elem-quote">此格式暂不支持预览</blockquote>
    }

</div>
